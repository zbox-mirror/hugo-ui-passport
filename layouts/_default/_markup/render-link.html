{{ $title := ((.Title) | default "") }}
{{ $href := ((.Destination) | safeURL) }}
{{ $text := ((.Text) | safeHTML) }}

{{ $viewer := "" }}{{ $target := "_self" }}{{ $rel := "" }}

{{ if (strings.HasPrefix .Destination "http") }}
    {{ $target = "_blank" }}{{ $rel = "noopener noreferrer nofollow" }}
    {{ $files := (slice ".doc" ".docx" ".xls" ".xlsx" ".ppt" ".pptx" ".odt" ".ods" ".odp") }}
    {{ range ($files) }}
        {{ with (strings.HasSuffix $href .) }}
            {{ $viewer = "https://view.officeapps.live.com/op/view.aspx?src=" }}
        {{ end }}
    {{ end }}
{{ end }}

<a title="{{ ($title) }}" href="{{ ($viewer) }}{{ ($href) }}" target="{{ ($target) }}" rel="{{ ($rel) }}">{{ ($text) }}</a>
